<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modifier une réservation - Hôtel California</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="flex flex-col min-h-screen bg-gray-50">
    <%- include('../partials/navbar') %>

        <div class="max-w-6xl mx-auto p-6 flex-1">
            <h1 class="text-2xl font-bold mb-4">Modifier une réservation</h1>

            <div class="bg-white border p-6">
                <% const now=new Date(); const start=new Date(reservation.dateDebut); const end=new
                    Date(reservation.dateFin); let statut='' ; if (now < start) statut='À venir' ; else if (now>= start
                    && now <= end) statut='En cours' ; else statut='Terminée' ; %>
                        <div class="mb-6 p-4 bg-gray-50 border">
                            <p class="mb-1"><strong>Séjour : </strong>Du <%= reservation.getFormattedDateDebut() %> au
                                    <%= reservation.getFormattedDateFin() %>
                            </p>
                            <p><strong>Statut : </strong>
                                <%= statut %>
                            </p>
                        </div>
                        <form action="/reservations/<%= reservation.idReservation %>/edit" method="post">
                            <input type="hidden" name="idReservation" value="<%= reservation.idReservation %>">

                            <div class="mb-4">
                                <label class="block font-bold mb-1">Numéro</label>
                                <input type="text" name="numero" value="<%= reservation.idReservation %>" required
                                    class="w-full border p-2">
                            </div>

                            <div class="mb-4">
                                <label class="block font-bold mb-1">Client</label>
                                <select name="idClient" required class="w-full border p-2">
                                    <% for (let client of clients) { %>
                                        <option value="<%= client.idClient %>" <%=reservation.idClient==client.idClient
                                            ? 'selected' : '' %>>
                                            <%= client.nom %>
                                                <%= client.prenom %>
                                        </option>
                                        <% } %>
                                </select>
                            </div>

                            <div class="mb-4">
                                <label class="block font-bold mb-1">Chambre</label>
                                <select name="idChambre" required class="w-full border p-2">
                                    <% for (let chambre of chambres) { %>
                                        <option value="<%= chambre.idChambre %>"
                                            <%=reservation.idChambre==chambre.idChambre ? 'selected' : '' %>>
                                            Chambre <%= chambre.numero %> - <%= chambre.capacite %> personne(s)
                                        </option>
                                        <% } %>
                                </select>
                            </div>

                            <div class="mb-4">
                                <label class="block font-bold mb-1">Date de début</label>
                                <input type="date" name="dateDebut" value="<%= reservation.getIsoDateDebut() %>" required
                                    class="w-full border p-2">
                            </div>

                            <div class="mb-4">
                                <label class="block font-bold mb-1">Date de fin</label>
                                <input type="date" name="dateFin" value="<%= reservation.getIsoDateFin() %>" required
                                    class="w-full border p-2">
                            </div>

                            <div class="flex gap-2">
                                <a href="/reservations"
                                    class="bg-gray-800 text-white px-4 py-2 hover:bg-gray-700">Annuler</a>
                                <button type="submit"
                                    class="bg-gray-800 text-white px-4 py-2 hover:bg-gray-700">Modifier</button>
                            </div>
                        </form>
            </div>
        </div>

        <%- include('../partials/footer') %>
</body>

</html>